<div class="mb-3">
  <label for="map" class="form-label">位置情報の登録（任意）</label>
  <button id="btn" class="btn btn-outline-primary me-2">
    現在位置取得
  </button>
  <input id="address" type="textbox">
  <input type="button" value="検索" onclick="codeAddress()" class="btn btn-outline-secondary">
  <div id='map'></div>
</div>
  
<style>
#map{
  height: 100px;
}
</style>

<script>
let map
let geocoder
let marker = null
// 基準地（東京都）の緯度経度
let lat = 35.6894
let lng = 139.6917

function initMap(){
  // geocoderの初期化
  geocoder = new google.maps.Geocoder()
  // インスタンスの作成
  map = new google.maps.Map(document.getElementById('map'), {
    zoom: 15,
    center: {lat: lat, lng: lng}
  });
  //初期マーカー
  marker = new google.maps.Marker({
    map: map,
    position: new google.maps.LatLng(lat, lng),
  });
  document.getElementById('lat').value = lat;
  document.getElementById('lng').value = lng;
  //マーカークリック時のイベント
  map.addListener('click', function(e) {
    dragMap(e.latLng, map);
  });
}

// 現在位置取得ボタンを押した時の処理
document.getElementById("btn").onclick = function(){
  navigator.geolocation.getCurrentPosition(successCallback, errorCallback);
};
// 取得に成功した場合の処理
function successCallback(position){
  lat = position.coords.latitude;
  lng = position.coords.longitude;
  document.getElementById("lat").value = lat;
  document.getElementById("lng").value = lng;
  map.setCenter(
    new google.maps.LatLng(lat, lng)
  );
  marker.setMap(null);
  marker = new google.maps.Marker({
    map: map,
    position: new google.maps.LatLng(lat, lng)
  });
};
// 取得に失敗した場合の処理
function errorCallback(error){
    alert("位置情報が取得できませんでした");
};

// 検索窓で検索した場合の処理
function codeAddress(){
  const inputAddress = document.getElementById('address').value;
  geocoder.geocode( {'address': inputAddress}, function(results, status) {
    if (status == 'OK') {
      let location = results[0].geometry.location;
      lat = location.lat();
      lng = location.lng();
      document.getElementById('lat').value = lat;
      document.getElementById('lng').value = lng;
      map.setCenter(location);
      marker = new google.maps.Marker({
        map: map,
        position: location
      });
    } else {
      alert('該当する結果がありませんでした：' + status);
    }
  });
}

// ピンの位置を修正した場合の処理
function dragMap(geo, map) {
  lat = geo.lat();
  lng = geo.lng();
  document.getElementById('lat').value = lat;
  document.getElementById('lng').value = lng;
  //中心にスクロール
  map.setCenter(geo);
  //マーカーの更新
  marker.setMap(null);
  marker = null;
  marker = new google.maps.Marker({
    map: map,
    position: geo
  });
}
</script>

緯度：<input type="text" id="lat" name="lat" value="" size="20">　経度：<input type="text" id="lng" name="lng" value="" size="20">